SQL> -- 1) WAQTD DNO AND NUMBER OF EMP WORKING IN EACH DEPT
SQL> -- IF THERE ARE AT LEAST 2 CLERKS IN EACH DEPT
SQL> SELECT DEPTNO, COUNT(*) AS TOTAL_CLERKS
  2  FROM EMP
  3  WHERE JOB = 'CLERK'
  4  GROUP BY DEPTNO
  5  HAVING COUNT(*) >= 2;

    DEPTNO TOTAL_CLERKS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
---------- ------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        20            2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 

SQL> -- 2) WAQTD DNO AND TOTAL SALARY NEEDED TO PAY ALL EMP IN EACH DEPT
SQL> -- IF THERE ARE AT LEAST 4 EMP IN EACH DEPT
SQL> SELECT DEPTNO, SUM(SAL) AS TOTAL_SALARY
  2  FROM EMP
  3  GROUP BY DEPTNO
  4  HAVING COUNT(*) >= 4;

    DEPTNO TOTAL_SALARY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
---------- ------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        30         9400                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        20        10875                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 

SQL> -- 3) WAQTD NUMBER OF EMP EARNING SAL MORE THAN 1200 IN EACH JOB
SQL> -- AND TOTAL SAL OF EACH JOB MUST EXCEED 3800
SQL> SELECT JOB,
  2  COUNT(*) AS TOTAL_EMP,
  3  SUM(SAL) AS TOTAL_SALARY
  4  FROM EMP
  5  WHERE SAL > 1200
  6  GROUP BY JOB
  7  HAVING SUM(SAL) > 3800;

JOB        TOTAL_EMP TOTAL_SALARY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
--------- ---------- ------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
SALESMAN           4         5600                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
PRESIDENT          1         5000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
MANAGER            3         8275                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
ANALYST            2         6000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       

SQL> -- 4) WAQTD DEPTNO AND NUMBER OF EMP WORKING
SQL> -- IF THERE ARE EXACTLY 2 MANAGERS IN EACH DEPT
SQL> SELECT DEPTNO, COUNT(*) AS TOTAL_MANAGERS
  2  FROM EMP
  3  WHERE JOB = 'MANAGER'
  4  GROUP BY DEPTNO
  5  HAVING COUNT(*) = 2;

no rows selected

SQL> -- 5) WAQTD JOB AND MAX SAL OF EMP IN EACH JOB
SQL> -- IF MAX SAL EXCEEDS 2600
SQL> SELECT JOB, MAX(SAL) AS MAX_SALARY
  2  FROM EMP
  3  GROUP BY JOB
  4  HAVING MAX(SAL) > 2600;

JOB       MAX_SALARY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
--------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
PRESIDENT       5000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
MANAGER         2975                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
ANALYST         3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    

SQL> -- 6) WAQTD THE SALARIES WHICH ARE REPEATED IN EMP TABLE
SQL> SELECT SAL, COUNT(*) AS OCCURRENCES
  2  FROM EMP
  3  GROUP BY SAL
  4  HAVING COUNT(*) > 1;

       SAL OCCURRENCES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
---------- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
      1250           2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
      3000           2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  

SQL> -- 7) WAQTD THE HIREDATES WHICH ARE DUPLICATED IN EMP TABLE
SQL> SELECT HIREDATE, COUNT(*) AS OCCURRENCES
  2  FROM EMP
  3  GROUP BY HIREDATE
  4  HAVING COUNT(*) > 1;

HIREDATE  OCCURRENCES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
--------- -----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
03-DEC-81           2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> -- 8) WAQTD AVG SALARY OF EACH DEPT
SQL> -- IF AVG SAL IS LESS THAN 3000
SQL> SELECT DEPTNO, AVG(SAL) AS AVG_SALARY
  2  FROM EMP
  3  GROUP BY DEPTNO
  4  HAVING AVG(SAL) < 3000;

    DEPTNO AVG_SALARY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        30 1566.66667                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        20       2175                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        10 2916.66667                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> -- 9) WAQTD DEPTNO
SQL> -- IF THERE ARE AT LEAST 3 EMP IN EACH DEPT
SQL> -- WHOSE NAME HAS CHAR 'A' OR 'S'
SQL> SELECT DEPTNO, COUNT(*) AS TOTAL_EMP
  2  FROM EMP
  3  WHERE ENAME LIKE '%A%' OR ENAME LIKE '%S%'
  4  GROUP BY DEPTNO
  5  HAVING COUNT(*) >= 3;

    DEPTNO  TOTAL_EMP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        30          5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
        20          4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> -- 10) WAQTD MIN AND MAX SAL OF EACH JOB
SQL> -- IF MIN SAL > 1000 AND MAX SAL < 5000
SQL> SELECT JOB,
  2  MIN(SAL) AS MIN_SALARY,
  3  MAX(SAL) AS MAX_SALARY
  4  FROM EMP
  5  GROUP BY JOB
  6  HAVING MIN(SAL) > 1000
  7  AND MAX(SAL) < 5000;

JOB       MIN_SALARY MAX_SALARY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
--------- ---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
SALESMAN        1250       1600                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
MANAGER         2450       2975                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
ANALYST         3000       3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         

SQL> SPOOL OFF
